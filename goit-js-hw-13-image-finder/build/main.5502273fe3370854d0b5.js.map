{"version":3,"sources":["webpack:///./index.js","webpack:///./templates/result-item.hbs"],"names":["refs","input","document","getElementById","resultSection","searchForm","searchButton","galleryParent","lightbox","querySelector","lightboxImage","lightboxOverlay","toTopButton","spinner","lastPageinfo","queryOptions","proxyUrl","searchValue","baseUrl","API_KEY","numberOfPage","perPage","getImages","SearchQuery","classList","add","remove","query","fetch","then","response","status","json","createMarkupResult","obj","console","log","hits","markup","output","insertAdjacentHTML","drawMarkup","map","item","TempalateResultItem","join","lightBox","openLightbox","event","url","target","dataset","source","setAttribute","window","addEventListener","handleKeyPress","closeLightbox","removeEventListener","handleOverlayClick","currentTarget","code","InfiniteScroll","path","this","pageIndex","history","responseType","scrollThreshold","on","images","JSON","parse","isVisible","contains","length","pageYOffset","documentElement","clientHeight","scrollTo","top","left","behavior","e","preventDefault","value","innerHTML","data","numberOfImages","PNotify","alert","text","delay","info","Handlebars","module","exports","template","container","depth0","helpers","partials","helper","alias1","nullContext","alias2","hooks","helperMissing","alias3","alias4","escapeExpression","webformatURL","call","largeImageURL","likes","views","comments","downloads"],"mappings":"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","file":"main.5502273fe3370854d0b5.js","sourcesContent":["import './SCSS/styles.scss';\nimport TempalateResultItem from './templates/result-item.hbs';\nimport PNotify from '../node_modules/pnotify/dist/es/PNotify';\nimport '../node_modules/pnotify/dist/PNotifyBrightTheme.css';\nimport InfiniteScroll from 'infinite-scroll';\n\nconst refs = {\n  input: document.getElementById('input'),\n  resultSection: document.getElementById('result-of-search'),\n  searchForm: document.getElementById('search-form'),\n  searchButton: document.getElementById('search-btn'),\n  galleryParent: document.getElementById('gallery'),\n  lightbox: document.querySelector('.lightbox'),\n  lightboxImage: document.querySelector('.lightbox__image'),\n  lightboxOverlay: document.querySelector('.lightbox__content'),\n  toTopButton: document.getElementById('to-top-btn'),\n  spinner: document.querySelector('.spinner-modal'),\n  lastPageinfo: document.querySelector('.last-page-info'),\n};\n\nconst queryOptions = {\n  proxyUrl: 'https://cors-anywhere.herokuapp.com/',\n  searchValue: '',\n  baseUrl:\n    'https://pixabay.com/api/?image_type=photo&orientation=horizontal&q=',\n  API_KEY: '12685146-fdd2799488131e47273c0b199',\n  numberOfPage: 1,\n  perPage: 30,\n};\n\nconst getImages = (SearchQuery, numberOfPage) => {\n  refs.spinner.classList.add('multi-spinner-visible');\n  refs.lastPageinfo.classList.remove('last-page-info--visible');\n  const query = `${SearchQuery}`;\n  return fetch(\n    queryOptions.proxyUrl +\n      queryOptions.baseUrl +\n      query +\n      '&' +\n      'page=' +\n      numberOfPage +\n      '&per_page=' +\n      queryOptions.perPage +\n      '&key=' +\n      queryOptions.API_KEY,\n  ).then(response => {\n    if (response.status) {\n      refs.spinner.classList.remove('multi-spinner-visible');\n    }\n    if (response.status == 200) {\n      return response.json();\n    }\n  });\n};\n\nfunction handleSearchQuery(e) {\n  e.preventDefault();\n  const query = refs.input.value;\n  if (query !== queryOptions.searchValue) {\n    refs.galleryParent.innerHTML = '';\n    getImages(query, queryOptions.numberOfPage).then(data => {\n      const numberOfImages = data.hits.length;\n      if (numberOfImages < queryOptions.perPage) {\n        refs.lastPageinfo.classList.add('last-page-info--visible');\n      }\n      if (numberOfImages < 1) {\n        PNotify.alert({\n          text: 'Ничего не найдено по Вашему запросу.',\n          delay: 1000,\n        });\n      } else createMarkupResult(data);\n    });\n  } else if (query === '') {\n    PNotify.info({\n      text: 'Укажите, что нужно найти пожалуйста.',\n      delay: 1000,\n    });\n  }\n\n  queryOptions.searchValue = query;\n}\n\nfunction createMarkupResult(obj) {\n  console.log(obj.hits);\n  const result = obj.hits;\n  const markup = result\n    .map(item => {\n      return TempalateResultItem(item);\n    })\n    .join('');\n  drawMarkup(markup, refs.galleryParent);\n}\n\nfunction drawMarkup(markup, output) {\n  output.insertAdjacentHTML('beforeend', markup);\n}\n\nconst lightBox = {\n  openLightbox(event) {\n    const url = event.target.dataset.source;\n\n    if (event.target === refs.galleryParent) return;\n\n    refs.lightbox.classList.add('is-open');\n    refs.lightboxImage.setAttribute('src', url);\n\n    window.addEventListener('keydown', lightBox.handleKeyPress);\n  },\n\n  closeLightbox() {\n    refs.lightbox.classList.remove('is-open');\n    refs.lightboxImage.setAttribute('src', ' ');\n\n    window.removeEventListener('keydown', lightBox.handleKeyPress);\n  },\n\n  handleOverlayClick(event) {\n    if (event.target !== event.currentTarget) {\n      return;\n    }\n\n    lightBox.closeLightbox();\n  },\n\n  handleKeyPress(event) {\n    if (event.code !== 'Escape') {\n      return;\n    }\n\n    lightBox.closeLightbox();\n  },\n};\n\nconst infScr = new InfiniteScroll(refs.galleryParent, {\n  path() {\n    return (\n      queryOptions.proxyUrl +\n      queryOptions.baseUrl +\n      '&per_page=18' +\n      '&key=' +\n      queryOptions.API_KEY +\n      '&q=' +\n      queryOptions.searchValue +\n      '&page=' +\n      this.pageIndex\n    );\n  },\n  history: false,\n  responseType: 'text',\n  scrollThreshold: 1200,\n});\n\ninfScr.on(`load`, response => {\n  const images = JSON.parse(response);\n  const isVisible = refs.lastPageinfo.classList.contains(\n    'last-page-info--visible',\n  );\n  if (images.hits.length < 1 && !isVisible) {\n    refs.lastPageinfo.classList.add('last-page-info--visible');\n  }\n  createMarkupResult(images);\n  // refs.spinner.classList.remove('multi-spinner-visible');\n});\n\n// infScr.on(`request`, () => {\n//   refs.spinner.classList.add('multi-spinner-visible');\n// }); //включение загрузочного экрана на подгрузке infinite\n\nfunction checkHeight() {\n  if (window.pageYOffset < document.documentElement.clientHeight) {\n    refs.toTopButton.classList.remove(`btn-up-visible`);\n  } else {\n    refs.toTopButton.classList.add(`btn-up-visible`);\n  }\n}\n\nfunction goToTop() {\n  window.scrollTo({\n    top: 100,\n    left: 100,\n    behavior: 'smooth',\n  });\n}\n\nwindow.addEventListener('scroll', checkHeight);\nrefs.toTopButton.addEventListener('click', goToTop);\nrefs.searchButton.addEventListener('click', handleSearchQuery);\nrefs.galleryParent.addEventListener('click', lightBox.openLightbox);\nrefs.lightboxOverlay.addEventListener('click', lightBox.handleOverlayClick);\nrefs.spinner.addEventListener('click', () => {\n  refs.spinner.classList.remove('multi-spinner-visible');\n});\n","var Handlebars = require(\"../../node_modules/handlebars/runtime.js\");\nfunction __default(obj) { return obj && (obj.__esModule ? obj[\"default\"] : obj); }\nmodule.exports = (Handlebars[\"default\"] || Handlebars).template({\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var helper, alias1=depth0 != null ? depth0 : (container.nullContext || {}), alias2=container.hooks.helperMissing, alias3=\"function\", alias4=container.escapeExpression;\n\n  return \"<li>\\r\\n    <div class=\\\"result-container\\\">\\r\\n        <img src=\"\n    + alias4(((helper = (helper = helpers.webformatURL || (depth0 != null ? depth0.webformatURL : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"webformatURL\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":3,\"column\":17},\"end\":{\"line\":3,\"column\":33}}}) : helper)))\n    + \" class=\\\"result-image\\\" alt=\\\"\\\" data-source=\"\n    + alias4(((helper = (helper = helpers.largeImageURL || (depth0 != null ? depth0.largeImageURL : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"largeImageURL\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":3,\"column\":74},\"end\":{\"line\":3,\"column\":91}}}) : helper)))\n    + \" />\\r\\n\\r\\n        <div class=\\\"stats\\\">\\r\\n            <p class=\\\"stats-item\\\">\\r\\n                <i class=\\\"material-icons\\\">thumb_up</i>\\r\\n                \"\n    + alias4(((helper = (helper = helpers.likes || (depth0 != null ? depth0.likes : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"likes\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":8,\"column\":16},\"end\":{\"line\":8,\"column\":25}}}) : helper)))\n    + \"\\r\\n            </p>\\r\\n            <p class=\\\"stats-item\\\">\\r\\n                <i class=\\\"material-icons\\\">visibility</i>\\r\\n                \"\n    + alias4(((helper = (helper = helpers.views || (depth0 != null ? depth0.views : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"views\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":12,\"column\":16},\"end\":{\"line\":12,\"column\":25}}}) : helper)))\n    + \"\\r\\n            </p>\\r\\n            <p class=\\\"stats-item\\\">\\r\\n                <i class=\\\"material-icons\\\">comment</i>\\r\\n                \"\n    + alias4(((helper = (helper = helpers.comments || (depth0 != null ? depth0.comments : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"comments\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":16,\"column\":16},\"end\":{\"line\":16,\"column\":28}}}) : helper)))\n    + \"\\r\\n            </p>\\r\\n            <p class=\\\"stats-item\\\">\\r\\n                <i class=\\\"material-icons\\\">cloud_download</i>\\r\\n                \"\n    + alias4(((helper = (helper = helpers.downloads || (depth0 != null ? depth0.downloads : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"downloads\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":20,\"column\":16},\"end\":{\"line\":20,\"column\":29}}}) : helper)))\n    + \"\\r\\n            </p>\\r\\n        </div>\\r\\n    </div>\\r\\n</li>\";\n},\"useData\":true});"],"sourceRoot":""}